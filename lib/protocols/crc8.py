# https://www.3dbrew.org/wiki/CRC-8-CCITT

_CCITT_TABLE = (
    b"\x00\x07\x0E\x09\x1C\x1B\x12\x15\x38\x3F\x36\x31\x24\x23\x2A\x2D"
    b"\x70\x77\x7E\x79\x6C\x6B\x62\x65\x48\x4F\x46\x41\x54\x53\x5A\x5D"
    b"\xE0\xE7\xEE\xE9\xFC\xFB\xF2\xF5\xD8\xDF\xD6\xD1\xC4\xC3\xCA\xCD"
    b"\x90\x97\x9E\x99\x8C\x8B\x82\x85\xA8\xAF\xA6\xA1\xB4\xB3\xBA\xBD"
    b"\xC7\xC0\xC9\xCE\xDB\xDC\xD5\xD2\xFF\xF8\xF1\xF6\xE3\xE4\xED\xEA"
    b"\xB7\xB0\xB9\xBE\xAB\xAC\xA5\xA2\x8F\x88\x81\x86\x93\x94\x9D\x9A"
    b"\x27\x20\x29\x2E\x3B\x3C\x35\x32\x1F\x18\x11\x16\x03\x04\x0D\x0A"
    b"\x57\x50\x59\x5E\x4B\x4C\x45\x42\x6F\x68\x61\x66\x73\x74\x7D\x7A"
    b"\x89\x8E\x87\x80\x95\x92\x9B\x9C\xB1\xB6\xBF\xB8\xAD\xAA\xA3\xA4"
    b"\xF9\xFE\xF7\xF0\xE5\xE2\xEB\xEC\xC1\xC6\xCF\xC8\xDD\xDA\xD3\xD4"
    b"\x69\x6E\x67\x60\x75\x72\x7B\x7C\x51\x56\x5F\x58\x4D\x4A\x43\x44"
    b"\x19\x1E\x17\x10\x05\x02\x0B\x0C\x21\x26\x2F\x28\x3D\x3A\x33\x34"
    b"\x4E\x49\x40\x47\x52\x55\x5C\x5B\x76\x71\x78\x7F\x6A\x6D\x64\x63"
    b"\x3E\x39\x30\x37\x22\x25\x2C\x2B\x06\x01\x08\x0F\x1A\x1D\x14\x13"
    b"\xAE\xA9\xA0\xA7\xB2\xB5\xBC\xBB\x96\x91\x98\x9F\x8A\x8D\x84\x83"
    b"\xDE\xD9\xD0\xD7\xC2\xC5\xCC\xCB\xE6\xE1\xE8\xEF\xFA\xFD\xF4\xF3"
)

def ccitt(data: bytes) -> int:
    """Calculate CRC-8-CCITT checksum for given data."""
    crc = 0
    for byte in data:
        crc = _CCITT_TABLE[crc ^ byte]
    return crc